
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/load_and_explore_poses.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_load_and_explore_poses.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_load_and_explore_poses.py:


Load and explore pose tracks
============================

Load and explore an example dataset of pose tracks.

.. GENERATED FROM PYTHON SOURCE LINES 9-11

Imports
-------

.. GENERATED FROM PYTHON SOURCE LINES 11-16

.. code-block:: default

    from matplotlib import pyplot as plt

    from movement import datasets
    from movement.io import load_poses








.. GENERATED FROM PYTHON SOURCE LINES 17-20

Fetch an example dataset
------------------------
Print a list of available datasets:

.. GENERATED FROM PYTHON SOURCE LINES 20-24

.. code-block:: default


    for file_name in datasets.list_pose_data():
        print(file_name)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    DLC_single-wasp.predictions.h5
    DLC_single-wasp.predictions.csv
    DLC_single-mouse_EPM.predictions.h5
    DLC_two-mice.predictions.csv
    SLEAP_single-mouse_EPM.analysis.h5
    SLEAP_single-mouse_EPM.predictions.slp
    SLEAP_two-mice_social-interaction.analysis.h5
    SLEAP_two-mice_social-interaction.predictions.slp
    SLEAP_three-mice_Aeon_proofread.analysis.h5
    SLEAP_three-mice_Aeon_proofread.predictions.slp




.. GENERATED FROM PYTHON SOURCE LINES 25-28

Fetch the path to an example dataset.
Feel free to replace this with the path to your own dataset.
e.g., ``file_path = "/path/to/my/data.h5"``)

.. GENERATED FROM PYTHON SOURCE LINES 28-32

.. code-block:: default

    file_path = datasets.fetch_pose_data_path(
        "SLEAP_three-mice_Aeon_proofread.analysis.h5"
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    0.00B [00:00, ?B/s]    39.9kB [00:00, 142kB/s]    0.00B [00:00, ?B/s]        0.00B [00:00, ?B/s]




.. GENERATED FROM PYTHON SOURCE LINES 33-35

Load the dataset
----------------

.. GENERATED FROM PYTHON SOURCE LINES 35-39

.. code-block:: default


    ds = load_poses.from_sleap_file(file_path, fps=50)
    print(ds)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset>
    Dimensions:      (time: 601, individuals: 3, keypoints: 1, space: 2)
    Coordinates:
      * time         (time) float64 0.0 0.02 0.04 0.06 ... 11.94 11.96 11.98 12.0
      * individuals  (individuals) <U10 'AEON3B_NTP' 'AEON3B_TP1' 'AEON3B_TP2'
      * keypoints    (keypoints) <U8 'centroid'
      * space        (space) <U1 'x' 'y'
    Data variables:
        pose_tracks  (time, individuals, keypoints, space) float64 770.3 ... 755.1
        confidence   (time, individuals, keypoints) float64 nan nan nan ... nan nan
    Attributes:
        fps:              50.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_three-mice_Aeon...




.. GENERATED FROM PYTHON SOURCE LINES 40-43

The loaded dataset contains two data variables:
``pose_tracks`` and ``confidence```
To get the pose tracks:

.. GENERATED FROM PYTHON SOURCE LINES 43-45

.. code-block:: default

    pose_tracks = ds.pose_tracks








.. GENERATED FROM PYTHON SOURCE LINES 46-51

Select and plot data with xarray
--------------------------------
You can use the ``sel`` method to index into ``xarray`` objects.
For example, we can get a ``DataArray`` containing only data
for a single keypoint of the first individual:

.. GENERATED FROM PYTHON SOURCE LINES 51-55

.. code-block:: default


    da = pose_tracks.sel(individuals="AEON3B_NTP", keypoints="centroid")
    print(da)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.DataArray 'pose_tracks' (time: 601, space: 2)>
    770.3 1.062e+03 773.3 1.062e+03 773.3 ... 618.6 194.6 618.4 194.6 616.4
    Coordinates:
      * time         (time) float64 0.0 0.02 0.04 0.06 ... 11.94 11.96 11.98 12.0
        individuals  <U10 'AEON3B_NTP'
        keypoints    <U8 'centroid'
      * space        (space) <U1 'x' 'y'




.. GENERATED FROM PYTHON SOURCE LINES 56-58

We could plot the x, y coordinates of this keypoint over time,
using ``xarray``'s built-in plotting methods:

.. GENERATED FROM PYTHON SOURCE LINES 58-60

.. code-block:: default

    da.plot.line(x="time", row="space", aspect=2, size=2.5)




.. image-sg:: /auto_examples/images/sphx_glr_load_and_explore_poses_001.png
   :alt: space = x, space = y
   :srcset: /auto_examples/images/sphx_glr_load_and_explore_poses_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <xarray.plot.facetgrid.FacetGrid object at 0x7fb0acc05390>



.. GENERATED FROM PYTHON SOURCE LINES 61-63

Similarly we could plot the same keypoint's x, y coordinates
for all individuals:

.. GENERATED FROM PYTHON SOURCE LINES 63-67

.. code-block:: default


    da = pose_tracks.sel(keypoints="centroid")
    da.plot.line(x="time", row="individuals", aspect=2, size=2.5)




.. image-sg:: /auto_examples/images/sphx_glr_load_and_explore_poses_002.png
   :alt: individuals = AEON3B_NTP, individuals = AEON3B_TP1, individuals = AEON3B_TP2
   :srcset: /auto_examples/images/sphx_glr_load_and_explore_poses_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <xarray.plot.facetgrid.FacetGrid object at 0x7fb0abab2010>



.. GENERATED FROM PYTHON SOURCE LINES 68-73

Trajectory plots
----------------
We are not limited to ``xarray``'s built-in plots.
For example, we can use ``matplotlib`` to plot trajectories
(using scatter plots):

.. GENERATED FROM PYTHON SOURCE LINES 73-87

.. code-block:: default


    mouse_name = "AEON3B_TP1"

    plt.scatter(
        da.sel(individuals=mouse_name, space="x"),
        da.sel(individuals=mouse_name, space="y"),
        s=2,
        c=da.time,
        cmap="viridis",
    )
    plt.title(f"Trajectory of {mouse_name}")
    plt.xlabel("x")
    plt.ylabel("y")
    plt.colorbar(label="time (sec)")



.. image-sg:: /auto_examples/images/sphx_glr_load_and_explore_poses_003.png
   :alt: Trajectory of AEON3B_TP1
   :srcset: /auto_examples/images/sphx_glr_load_and_explore_poses_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.colorbar.Colorbar object at 0x7fb0a9945410>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 2.780 seconds)


.. _sphx_glr_download_auto_examples_load_and_explore_poses.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: load_and_explore_poses.py <load_and_explore_poses.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: load_and_explore_poses.ipynb <load_and_explore_poses.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
